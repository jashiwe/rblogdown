---
title: 又见散点图
tags:
categories: R

---

```{r}
library(tidyverse)
library(patchwork)#图片组合
library(cowplot)#图片组合
library(ggsci)
mtcars<-mtcars %>% 
  as_tibble() %>% 
  mutate(cyl=as.factor(cyl))

p1<-ggplot(mtcars,aes(mpg,qsec,color=cyl))+
  geom_point(size=2,shape=1,fill='gray')+
  theme_classic()+
  scale_color_jama()+
  theme(legend.position = c(0.1,0.8))

p2<-ggplot(mtcars,aes(mpg,qsec,color=cyl))+
  geom_point(size=2,shape=1,fill='gray')+
  theme_classic()+
  scale_color_aaas()+
  theme(legend.position = c(0.1,0.8))

plot_grid(p1,p2,ncol = 2,labels = c('A','B'),align = "vh")
```

# 除了size,color,shape等属性，散点还有一个属性：stroke。用于改变空心点的边框粗细

```{r}
mtcars<-mtcars %>% 
  as_tibble() %>% 
  mutate(cyl=factor(cyl))
ggplot(mtcars,aes(mpg,qsec,color=cyl))+
  geom_point(size=2,shape=1,stroke=1.5)+
  theme_classic()+
  scale_fill_lancet()+
  theme(legend.position = c(0.1,0.8))
```

# 以上cyl是分类变量，如果是李榄圩悉尼港变量，颜色而映射还是遵循cyl变量的取值规律.

```{r}
mtcars<-mtcars %>% 
  as_tibble() %>% 
  mutate(cyl=as.numeric(as.character(cyl)))

ggplot(mtcars,aes(mpg,qsec,color=cyl))+
  geom_point(size=2,shape=1)+
  theme_classic()+
  scale_color_gradient(low = '#fee0d2',high = '#de2d26')+
  theme(legend.position = c(0.1,0.8))
```

# 上色的两种颜色，aes里属于映射，color参数会覆盖映射。

```{r}
dsamp<-diamonds[sample(nrow(diamonds),100),]
ggplot(dsamp,aes(carat,price))+
  geom_point(aes(color=depth))+
  scale_color_gradient(low = '#fde0dd',high = '#c51b8a')+
  theme(legend.position = c(0.85,0.25))
```

# 通过数据处理，减去中位数绘图

```{r}
dsamp<-dsamp %>% 
  mutate(depth=depth-median(depth))

p1<-ggplot(dsamp,aes(carat,price,fill=depth))+
  geom_point(shape=21,color='black',size=2)+
  theme_classic()+
  scale_fill_gradient2(low = '#41ab5d',mid = 'white',high = '#e31a1c',
                       midpoint = 0)+
  theme(legend.position = c(0.1,0.8))

p2<-ggplot(dsamp,aes(carat,price,fill=depth))+
  geom_point(shape=21,color='black',size=2)+
  theme_classic()+
  scale_fill_gsea()+
  theme(legend.position = c(0.1,0.8))

plot_grid(p1,p2,ncol = 2,labels = c('A','B'),align = 'vh')
```
