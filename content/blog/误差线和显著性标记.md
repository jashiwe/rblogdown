---
title: 柱形图添加误差线和显著性差异
tags:
categorier: R
---

```R
# ggplot2绘制柱形图并添加误差线和显著性标记
# 剪贴板复制粘贴数据的读入
df<-read.table('clipboard',header = T)
library(ggplot2)
install.packages('ggsignif')
library(ggsignif)
ggplot(data = df,aes(x,y))+
  stat_summary(geom='bar',
               fun = mean,
               aes(fill=x))+
  stat_summary(geom = 'errorbar',
               fun.min = min,
               fun.max = max,
               width=0.2)+
  geom_signif(comparisons = list(c('a','b'),
                                 c('b','c'),
                                 c('a','c')),
              test = 't.test',
              y_position = c(10,17,18)，#根据坐标调整
              map_signif_level = T)+
  scale_y_continuous(expand = c(0,0),limits = c(0,20))+
  theme_bw()+
  scale_fill_manual(values = c('steelblue','yellowgreen',
                               'violetred1'))+
  theme(legend.title = element_blank())+
  labs(x='AAA',
       y='BBB',
       title ='CCC',
       caption = 'DDD')+
  theme(panel.grid = element_blank())
```
